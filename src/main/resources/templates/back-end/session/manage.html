<div th:fragment="content">

    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --bg-color: #f4f7f6;
        }

        .session-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 25px;
        }

        .control-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
            background: #f9f9f9;
            padding: 20px;
            border-radius: 6px;
        }

        select, input[type="time"] {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        button {
            padding: 6px 14px;
            border-radius: 4px;
            border: none;
            font-weight: bold;
            cursor: pointer;
        }

        .btn-add { background: var(--success-color); color: #fff; }
        .btn-update { background: var(--primary-color); color: #fff; font-size: 12px; }
        .btn-on { background: #d4edda; color: #155724; }
        .btn-off { background: #f8d7da; color: #721c24; }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        th { background: #f8f9fa; }

        .time-edit-form {
            display: flex;
            gap: 5px;
            align-items: center;
        }
    </style>

    <div class="session-container">

        <h2>üé¨ Â†¥Ê¨°ÁÆ°ÁêÜÁ≥ªÁµ±</h2>

        <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
        <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>

        <!-- Êü•Ë©¢ / Êñ∞Â¢û -->
        <div class="control-panel">

            <form th:action="@{/session/}" method="get">
                <strong>üîç Â†¥Ê¨°Êü•Ë©¢</strong><br>
                <select name="searchDate" onchange="this.form.submit()">
                    <option th:each="date : ${dateList}"
                            th:value="${date}"
                            th:text="${date}"
                            th:selected="${date == selectedDate}">
                    </option>
                </select>
            </form>

            <form th:action="@{/session/add}" method="post">
                <strong>‚ûï Êñ∞Â¢ûÂ†¥Ê¨°</strong><br>
                <input type="hidden" name="searchDate" th:value="${selectedDate}">

                <select name="movieId" required>
                    <option value="">ÈÅ∏ÊìáÈõªÂΩ±</option>
                    <option th:each="m : ${movieList}"
                            th:value="${m.movieId}"
                            th:text="${m.nameTw}">
                    </option>
                </select>

                <select name="cinemaId" required>
                    <option th:each="c : ${cinemaList}"
                            th:value="${c.cinemaId}"
                            th:text="${c.cinemaName}">
                    </option>
                </select>

                <input type="time" name="startTimeStr" required>
                <button class="btn-add">Êñ∞Â¢û</button>
            </form>

        </div>

        <!-- Ë°®Ê†º -->
        <table>
            <thead>
            <tr>
                <th>Á∑®Ëôü</th>
                <th>ÈõªÂΩ±</th>
                <th>ÂΩ±Âª≥</th>
                <th>ÈñãÂßãÊôÇÈñì</th>
                <th>ÁµêÊùü</th>
                <th>ÁãÄÊÖã</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="s : ${sessionList}">
                <td th:text="${s.sessionId}"></td>
                <td>
                    <strong th:text="${s.movie.nameTw}"></strong><br>
                    <small th:text="${s.movie.duration + ' ÂàÜÈêò'}"></small>
                </td>
                <td th:text="${s.cinema.cinemaName}"></td>

                <td>
                    <form th:action="@{/session/updateTime}" method="post" class="time-edit-form">
                        <input type="hidden" name="sessionId" th:value="${s.sessionId}">
                        <input type="time" name="newStartTimeStr"
                               th:value="${#dates.format(s.startTime, 'HH:mm')}" required>
                        <button class="btn-update">‰øÆÊîπ</button>
                    </form>
                </td>

                <td th:text="${#dates.format(s.endTime, 'HH:mm')}"></td>

                <td>
                    <form th:action="@{/session/updateStatus}" method="post">
                        <input type="hidden" name="sessionId" th:value="${s.sessionId}">
                        <button th:text="${s.sessionStatus == 1 ? '‰∏äÊò†‰∏≠' : 'Â∑≤‰∏ãÊû∂'}"
                                th:class="${s.sessionStatus == 1 ? 'btn-on' : 'btn-off'}">
                        </button>
                    </form>
                </td>
            </tr>

            <tr th:if="${#lists.isEmpty(sessionList)}">
                <td colspan="6" class="text-center text-muted py-4">
                    Â∞öÁÑ°Â†¥Ê¨°Ë≥áÊñô
                </td>
            </tr>
            </tbody>
        </table>

    </div>
</div>
