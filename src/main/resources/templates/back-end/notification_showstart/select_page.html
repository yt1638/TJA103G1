<div th:fragment="content">
  <style>
    /* 1. 頁面標題樣式 */
    .page-title {
      font-size: 24px;
      font-weight: 700;
      color: #1f3c88;
      border-bottom: 2px solid #1f3c88;
      padding-bottom: 4px;
      margin-bottom: 18px;
      display: inline-block;
    }

    /* 2. 查詢區塊：強制一行，移除導致換行的過大 margin */
    .search-bar-wrapper {
      background: #e9eaec;
      border-radius: 10px;
      padding: 15px 20px;
      display: flex;
      align-items: center; /* 垂直置中 */
      flex-wrap: nowrap;   /* 強制不換行 */
      gap: 15px;           /* 使用 gap 代替 margin，間距更精準 */
    }

    .search-group {
      display: flex;
      align-items: center;
      flex-shrink: 0;      /* 防止欄位被壓縮變形 */
    }

    .search-group label {
      margin-right: 8px;
      font-weight: 600;
      color: #000;
      white-space: nowrap; /* 標籤文字絕不換行 */
    }

    /* 調整 input 寬度，確保三個欄位能並列 */
    .search-group input {
      width: 150px; 
      height: 38px;
      color: #000;
      font-weight: 500;
      border-radius: 6px;
      border: 1px solid #ced4da;
    }

    .search-group input::placeholder {
      color: #888;
    }

    /* 搜尋按鈕置右 */
    .search-submit {
      margin-left: auto; 
      flex-shrink: 0;
    }

    .search-btn {
      background-color: #000;
      color: #fff;
      border-radius: 999px;
      padding: 8px 24px;
      font-weight: 600;
      border: none;
      cursor: pointer;
    }

    .search-btn:hover {
      background-color: #333;
    }

    /* 編輯按鈕樣式 */
    .edit-preference-btn {
      background-color: #000;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      text-decoration: none;
    }

    /* 表格置中 */
    .table thead th, .table tbody td {
      text-align: center;
      vertical-align: middle;
    }

    .error-msg {
      color: red;
      font-weight: 700;
      margin-top: 10px;
    }
  </style>

  <div class="container-fluid">
    <div class="page-title-bar d-flex justify-content-between align-items-center mb-3">
      <span class="page-title">開演通知查詢</span>
      <a class="edit-preference-btn" th:href="@{/notification_showstart/update_notificationShowstart_input}">
        開演通知編輯
      </a>
    </div>

    <div th:if="${errorMessage}" class="error-msg" th:text="${errorMessage}"></div>
    <div id="clientError" class="error-msg"></div>

    <form method="post" th:action="@{/notification_showstart/listNotificationShowstarts_ByCompositeQuery}" onsubmit="return validateForm();">
      <div class="search-bar-wrapper">

        <div class="search-group">
          <label>已發送日期：</label>
          <input type="date" class="form-control" name="notiShowstStime">
        </div>

        <div class="search-group">
          <label>會員編號：</label>
          <input type="text" class="form-control" name="memberId" placeholder="請輸入編號">
        </div>

        <div class="search-group">
          <label>場次編號：</label>
          <input type="text" class="form-control" name="sessionId" placeholder="請輸入編號">
        </div>

        <div class="search-submit">
          <button type="submit" class="btn search-btn">搜尋</button>
        </div>

      </div>
    </form>

    <div class="mt-4">
      <div class="card shadow">
        <div class="card-body p-0">
          <div class="table-responsive">
            <table class="table table-bordered mb-0">
              <thead>
                <tr>
                  <th>會員編號</th>
                  <th>場次編號</th>
                  <th>通知日期</th>
                  <th>發送狀態</th>
                  <th>發送內容</th>
                </tr>
              </thead>
              <tbody>
                <th:block th:if="${notificationShowstartVOListData != null and !#lists.isEmpty(notificationShowstartVOListData)}">
                  <tr th:each="noti : ${notificationShowstartVOListData}">
                    <td th:text="${noti.member.memberId}"></td>
                    <td th:text="${noti.session.sessionId}"></td>
                    <td th:text="${noti.notiShowstStime}"></td>
                    <td th:text="${noti.notiShowstStat == 1 ? '已發送' : '未發送'}"></td>
                    <td th:text="${noti.notiShowstScon}"></td>
                  </tr>
                </th:block>
                <th:block th:unless="${notificationShowstartVOListData != null and !#lists.isEmpty(notificationShowstartVOListData)}">
                  <tr>
                    <td colspan="5" class="text-center text-muted py-4">查無資料</td>
                  </tr>
                </th:block>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function validateForm() {
      const memberId  = document.querySelector("[name='memberId']").value.trim();
      const sessionId = document.querySelector("[name='sessionId']").value.trim(); 
      const date      = document.querySelector("[name='notiShowstStime']").value.trim();

      let errors = [];
      if (!memberId && !sessionId && !date) {
        errors.push("請至少輸入一個查詢條件");
      }

      const errorDiv = document.getElementById("clientError");
      if (errors.length > 0) {
        errorDiv.innerHTML = errors.join("<br>");
        return false;
      }
      return true;
    }
  </script>
</div>